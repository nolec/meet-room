# 카카오 로컬 API 설정 가이드

## 1. 카카오 개발자 센터에서 애플리케이션 등록

### 1-1. 애플리케이션 등록

1. [카카오 개발자 센터](https://developers.kakao.com/)에 로그인
2. **"내 애플리케이션"** → **"애플리케이션 추가하기"** 클릭

### 1-2. 기본 정보 입력

- **앱 이름**: "너브스" (또는 원하는 이름)
- **사업자명**: 개인/회사명 입력
- **앱 실행 환경**: **"Web"** 선택

### 1-3. 플랫폼 설정

**Web 플랫폼** 추가:

- **사이트 도메인**:
  - 개발 환경: `http://localhost:3000`
  - 프로덕션: 실제 도메인 (예: `https://yourdomain.com`)

### 1-4. API 키 발급

1. 애플리케이션 등록 완료 후
2. **"내 애플리케이션"** → 등록한 애플리케이션 클릭
3. **"앱 키"** 탭에서 **"REST API 키"** 확인/복사

### 1-5. API 사용 설정 (⚠️ 중요!)

1. **"제품 설정"** → **"로컬"** 선택
2. **"로컬"** 제품을 **활성화** (토글 스위치를 ON으로 변경)
   - 왼쪽 상단의 **"로컬"** 토글 스위치가 켜져 있어야 합니다
3. 약관 동의:
   - **"로컬 API"** 약관에 동의
   - **"카카오맵 API"** 약관에 동의 (필요한 경우)
4. **저장** 버튼 클릭

**⚠️ 중요**: 
- "App(테스트) disabled OPEN_MAP_AND_LOCAL service" 오류는 로컬 API가 비활성화되어 있을 때 발생합니다
- 반드시 **"로컬"** 제품의 토글 스위치가 **ON** 상태여야 합니다
- 약관에 동의하지 않으면 API를 사용할 수 없습니다

## 2. 환경 변수 설정

### 2-1. 환경 변수 파일 수정

프로젝트 루트의 `env/.env.local` 파일에 다음 내용을 추가합니다:

```env
# 카카오 API 설정
KAKAO_REST_API_KEY=your_rest_api_key_here

# 기존 설정 유지
# NAVER_CLIENT_ID=...
# NAVER_CLIENT_SECRET=...
# SUPABASE_URL=...
# SUPABASE_ANON_KEY=...
```

**주의사항:**

- `your_rest_api_key_here`를 실제 REST API 키로 교체하세요
- 이 파일은 `.gitignore`에 포함되어 있어 Git에 커밋되지 않습니다

## 3. 서버 재시작

환경 변수를 추가한 후에는 개발 서버를 재시작해야 합니다:

```bash
# 개발 서버 중지 (Ctrl+C)
# 개발 서버 재시작
yarn dev
```

## 4. 확인

대시보드 페이지에서:

1. 위치 정보 접근 권한 허용
2. 주변 가게가 카카오 API를 통해 표시되는지 확인

## 카카오 로컬 API 특징

### 장점

- ✅ 위치 기반 검색 직접 지원 (거리순 정렬)
- ✅ 카테고리별 검색 지원 (카페, 음식점 등)
- ✅ 공식 오픈 API로 안정적
- ✅ 상세한 문서 제공

### 카테고리 코드

- `CE7`: 카페
- `FD6`: 음식점
- 기타 카테고리는 [카카오 개발자 문서](https://developers.kakao.com/docs/latest/ko/local/dev-guide#search-by-category) 참고

### 제한사항

- 한 번에 최대 15개 결과만 반환 가능
- 검색 반경 최대 20km

## 문제 해결

### 오류: "카카오 API 키가 설정되지 않았습니다"

- `env/.env.local` 파일이 올바른 위치에 있는지 확인
- 환경 변수 이름이 정확한지 확인 (`KAKAO_REST_API_KEY`)
- 서버를 재시작했는지 확인

### 오류: "카카오 API 호출 실패: 401"

- REST API 키가 올바른지 확인
- 로컬 API가 활성화되어 있는지 확인
- 사이트 도메인이 올바르게 등록되어 있는지 확인

### 오류: "App(테스트) disabled OPEN_MAP_AND_LOCAL service" ⚠️

이 오류는 **로컬 API가 비활성화**되어 있을 때 발생합니다. 다음을 확인하세요:

1. **카카오 개발자 센터** 접속: https://developers.kakao.com/
2. **"내 애플리케이션"** → 해당 앱 선택
3. **"제품 설정"** → **"로컬"** 메뉴 클릭
4. **"로컬"** 제품의 **토글 스위치가 ON**인지 확인
   - OFF 상태라면 ON으로 변경
5. **약관 동의** 확인:
   - "로컬 API" 약관에 동의했는지 확인
   - 동의하지 않았다면 약관에 동의
6. **저장** 버튼 클릭
7. 서버 재시작 후 다시 시도

**참고**: 
- 테스트 앱의 경우 일부 제한이 있을 수 있습니다
- 프로덕션 배포 시에는 앱을 **운영** 상태로 변경해야 합니다

### 오류: "카카오 API 호출 실패: 403"

- API 사용량 제한 확인
- 로컬 API 약관에 동의했는지 확인
- 플랫폼 설정이 올바른지 확인 (Web 플랫폼 등록)

## 참고 자료

- [카카오 로컬 API 개발 가이드](https://developers.kakao.com/docs/latest/ko/local/dev-guide)
- [카카오 로컬 API 카테고리 검색](https://developers.kakao.com/docs/latest/ko/local/dev-guide#search-by-category)
- [카카오 로컬 API 키워드 검색](https://developers.kakao.com/docs/latest/ko/local/dev-guide#search-by-keyword)
